import{b as j,r as o,d as w,s as u,j as e,e as N,m as l,A as E}from"./index-DMHo1UD5.js";const S=()=>{const d=j(),[g,c]=o.useState([]),[b,k]=o.useState(!0),[p,y]=o.useState(null),[r,x]=o.useState({status:"all",search:"",sortBy:"date"}),h=o.useCallback(async()=>{var t,a,n,s,f;try{const i=await w.get("/users/events");i.data&&Array.isArray(i.data)?c(i.data||[]):c(((t=i.data)==null?void 0:t.data)||[]),y(null)}catch(i){console.error("Error fetching events:",i),y(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"Failed to fetch your events"),u.error(((f=(s=i.response)==null?void 0:s.data)==null?void 0:f.message)||"Failed to fetch your events")}finally{k(!1)}},[]);o.useEffect(()=>{h()},[h]);const v=async t=>{var a,n;if(window.confirm("Are you sure you want to delete this event? This action cannot be undone."))try{await w.delete(`/events/${t}`),u.success("Event deleted successfully"),c(g.filter(s=>s._id!==t))}catch(s){console.error("Error deleting event:",s),u.error(((n=(a=s.response)==null?void 0:a.data)==null?void 0:n.message)||"Failed to delete event")}},m=g.filter(t=>{const a=r.search.toLowerCase(),n=!a||t.title.toLowerCase().includes(a)||t.location.toLowerCase().includes(a),s=r.status==="all"||t.status===r.status;return n&&s}).sort((t,a)=>r.sortBy==="date"?new Date(t.date)-new Date(a.date):r.sortBy==="title"?t.title.localeCompare(a.title):r.sortBy==="price"?t.price-a.price:0);return b?e.jsx("div",{className:"container mx-auto px-4 py-8 min-h-screen-except-nav-footer flex items-center justify-center",children:e.jsx(N,{type:"spinner",size:"large",text:"Loading events..."})}):p?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"p-4 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg shadow-md",children:p})}):e.jsxs(l.div,{initial:{opacity:0},animate:{opacity:1},className:"container mx-auto px-4 py-8 min-h-screen-except-nav-footer",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white mb-6",children:"My Events"}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 space-y-4 md:space-y-0 md:space-x-4",children:[e.jsx("div",{className:"flex-1 w-full md:w-auto",children:e.jsx("input",{type:"text",placeholder:"Search by title or location...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400",value:r.search,onChange:t=>x({...r,search:t.target.value})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 w-full md:w-auto",children:[e.jsxs("select",{className:"block w-full sm:w-auto px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",value:r.status,onChange:t=>x({...r,status:t.target.value}),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"declined",children:"Declined"})]}),e.jsxs("select",{className:"block w-full sm:w-auto px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",value:r.sortBy,onChange:t=>x({...r,sortBy:t.target.value}),children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"title",children:"Sort by Title"}),e.jsx("option",{value:"price",children:"Sort by Price"})]})]}),e.jsxs("div",{className:"flex space-x-4 w-full md:w-auto",children:[e.jsx("button",{onClick:()=>{console.log("Navigating to analytics..."),d("/organizer/analytics")},className:"w-1/2 md:w-auto bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Analytics"}),e.jsx("button",{onClick:()=>d("/organizer/events/new"),className:"w-1/2 md:w-auto bg-green-600 dark:bg-green-500 hover:bg-green-700 dark:hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Create Event"})]})]}),m.length===0?e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No events found matching your criteria. Create your first event!"}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Event"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Location"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tickets"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:e.jsx(E,{children:m.map(t=>{var a;return e.jsxs(l.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.title}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["$",(a=t.price)==null?void 0:a.toFixed(2)]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[new Date(t.date).toLocaleDateString()," at ",t.time]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t.location}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full uppercase shadow-sm 
                        ${t.status==="approved"?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":t.status==="declined"?"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100":"bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100"}`,children:t.status})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[t.remainingTickets," / ",t.totalTickets," available"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-3",children:[e.jsx("button",{onClick:()=>d(`/organizer/events/edit/${t._id}`),className:"text-blue-600 dark:text-blue-400 hover:underline transition-colors duration-200",children:"Edit"}),e.jsx("button",{onClick:()=>v(t._id),className:"text-red-600 dark:text-red-400 hover:underline transition-colors duration-200",children:"Delete"})]})]},t._id)})})})]})})})]})};export{S as default};
