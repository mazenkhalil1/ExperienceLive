import{r as l,b as L,j as e,m as a,d as B,s as b,f as E,u as C,a as z,e as F,L as I,R as w,A as M}from"./index-DXQrGHds.js";const D=({event:n,onBookingComplete:g})=>{const[i,x]=l.useState(1),[o,t]=l.useState(!1),v=L(),k=n.price*i,s=n.remainingTickets||0,u=d=>{const r=parseInt(d.target.value);r>0&&r<=s&&x(r)},f=async d=>{var r,m;d.preventDefault(),t(!0);try{const c=await B.post("/bookings",{eventId:n._id,quantity:i});b.success("Booking successful!"),g&&g(c.data),v("/bookings")}catch(c){console.error("Booking error:",c),b.error(((m=(r=c.response)==null?void 0:r.data)==null?void 0:m.message)||"Failed to book tickets")}finally{t(!1)}};return s===0?e.jsx(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-4 bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg shadow-md",children:"Sold Out"}):e.jsxs(a.form,{onSubmit:f,className:"space-y-6 bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Number of Tickets",e.jsxs("span",{className:"ml-2 text-sm text-gray-500 dark:text-gray-400",children:["(Available: ",s,")"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:"1",max:s,value:i,onChange:u,className:`mt-1 block w-full rounded-lg border-gray-300 dark:border-gray-600 \r
                     dark:bg-gray-700 dark:text-white shadow-sm \r
                     focus:border-blue-500 focus:ring-blue-500 \r
                     dark:focus:border-blue-400 dark:focus:ring-blue-400\r
                     transition-colors duration-200`}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsxs("svg",{className:"h-5 w-5 text-gray-400 dark:text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),e.jsxs(a.div,{className:"text-lg font-semibold text-gray-800 dark:text-white",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:["Total Price: ",e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["$",k.toFixed(2)]})]}),e.jsx(a.button,{type:"submit",disabled:o||i>s,className:`w-full py-3 px-4 rounded-lg text-white font-medium shadow-lg
          transition-all duration-200
          ${o||i>s?"bg-gray-400 dark:bg-gray-600 cursor-not-allowed":"bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600"}`,whileHover:!o&&i<=s?{scale:1.02}:{},whileTap:!o&&i<=s?{scale:.98}:{},children:o?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(a.div,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),e.jsx("span",{className:"ml-2",children:"Booking..."})]}):"Book Tickets"})]})},U=()=>{var N;const{id:n}=E(),g=L(),{isAuthenticated:i,user:x}=C(),{isDarkMode:o}=z(),[t,v]=l.useState(null),[k,s]=l.useState(!0),[u,f]=l.useState(null),[d,r]=l.useState(!1),m=async()=>{var y,p;try{const h=await B.get(`/events/${n}`);if(h.data.success)v(h.data.data);else throw new Error("Failed to fetch event details")}catch(h){console.error("Error fetching event details:",h),f(((p=(y=h.response)==null?void 0:y.data)==null?void 0:p.message)||"Failed to load event details"),b.error("Failed to load event details")}finally{s(!1)}};l.useEffect(()=>{m()},[n,m]);const c=()=>{b.success("Booking completed successfully!"),g(w.BOOKINGS)};if(k)return e.jsx(F,{});if(u)return e.jsx(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center text-red-500 dark:text-red-400 py-8",children:u});if(!t)return e.jsx(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Event not found"});const j=new Date(t.date),S=j.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),T=t.time||j.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return e.jsxs(a.div,{initial:{opacity:0},animate:{opacity:1},className:"",children:[e.jsxs("div",{className:"relative h-[50vh] md:h-[60vh] lg:h-[70vh] overflow-hidden",children:[e.jsx("img",{src:t.image||"https://via.placeholder.com/1200x600",alt:t.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-end pb-12 px-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto w-full text-white",children:[e.jsx(a.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"text-4xl md:text-6xl font-bold drop-shadow-lg",children:t.title}),e.jsx(a.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"text-xl md:text-2xl mt-2 drop-shadow-lg",children:t.location})]})})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-[-8vh] z-10 relative",children:[e.jsxs(a.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 md:p-8 grid grid-cols-1 md:grid-cols-3 gap-6 items-center",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-gray-800 dark:text-white mb-4",children:t.title}),e.jsxs("div",{className:"space-y-3 text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsxs("span",{children:[S," at ",T]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-5 h-5 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{children:t.location})]})]})]}),e.jsxs("div",{className:"md:col-span-1 text-left md:text-right",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-2",children:"Organized by:"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:((N=t.organizer)==null?void 0:N.name)||"N/A"})]})]}),e.jsxs(a.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},className:"mt-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 md:p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white mb-4",children:"About Event"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:t.description})]}),t.venue&&e.jsxs(a.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.8},className:"mt-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 md:p-8 grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white mb-4",children:"Venue"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2",children:t.venue.name}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.venue.location}),e.jsxs("div",{className:"flex space-x-4 mt-4",children:[t.venue.profileUrl&&e.jsx("a",{href:t.venue.profileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Open Venue Profile"}),t.venue.mapUrl&&e.jsx("a",{href:t.venue.mapUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Open In Maps"})]}),t.venue.facilities&&t.venue.facilities.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-3",children:"Facilities"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 text-gray-600 dark:text-gray-300",children:t.venue.facilities.map((y,p)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:y})]},p))})]})]}),t.venue.image&&e.jsx("div",{children:e.jsx("img",{src:t.venue.image,alt:"Venue Image",className:"w-full h-64 object-cover rounded-lg shadow-md"})})]}),e.jsxs("div",{className:"md:col-span-3 flex flex-col items-center space-y-4 mt-4",children:[i?(x==null?void 0:x.role)==="user"&&e.jsx(a.button,{onClick:()=>r(!d),className:"px-6 py-3 bg-yellow-500 text-gray-900 font-bold rounded-lg shadow-lg hover:bg-yellow-600 transition-colors duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Book Now"}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Please log in to book tickets."}),e.jsx(I,{to:w.LOGIN,state:{from:`/events/${n}`,message:"Please login to book tickets for this event."},className:"px-6 py-3 bg-blue-500 text-white font-bold rounded-lg shadow-lg hover:bg-blue-600 transition-colors duration-200",children:"Login to Book"})]}),e.jsx(M,{children:d&&t&&e.jsx(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:e.jsx(D,{event:t,onClose:()=>r(!1),onBookingComplete:c})})})]})]})]})};export{U as default};
