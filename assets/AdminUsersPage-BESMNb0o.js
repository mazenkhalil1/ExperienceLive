import{r as t,j as e,M as C,d as N,s as M,e as U,a as E,m as w,Q as j,A as R}from"./index-DMHo1UD5.js";const D=({isOpen:s,onClose:r,onUpdate:i,currentRole:n,userName:x})=>{const[p,m]=t.useState(n),y=h=>{h.preventDefault(),console.log("UpdateUserRoleModal: handleSubmit triggered"),i(p)};return e.jsx(C,{isOpen:s,onRequestClose:r,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Update User Role"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Update role for user: ",e.jsx("span",{className:"font-semibold",children:x})]}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Select New Role"}),e.jsxs("select",{value:p,onChange:h=>m(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"organizer",children:"Organizer"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Update Role"})]})]})]})})},L=({isOpen:s,onClose:r,onConfirm:i,title:n,message:x})=>e.jsx(C,{isOpen:s,onRequestClose:r,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:n}),e.jsx("p",{className:"text-gray-600 mb-6",children:x}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{onClick:()=>{console.log("ConfirmationDialog: Delete button clicked"),i()},className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete"})]})]})}),$=({isOpen:s,onClose:r,userId:i})=>{const[n,x]=t.useState(null),[p,m]=t.useState(!0),[y,h]=t.useState(null);t.useEffect(()=>{s&&i&&c()},[s,i]);const c=async()=>{var l,o;try{m(!0);const a=await N.get(`/users/${i}`);if(a.data.success)x(a.data.data);else throw new Error("Failed to fetch user details");h(null)}catch(a){console.error("Error fetching user details:",a),h(((o=(l=a.response)==null?void 0:l.data)==null?void 0:o.message)||"Failed to load user details"),M.error("Failed to load user details")}finally{m(!1)}},u=l=>{if(!l)return"N/A";try{const o=new Date(l),a=new Date;if(o>a||Math.abs(a-o)<1e3*60*1)return"Today";const f=Math.abs(a-o),g=Math.floor(f/(1e3*60*60*24)),v=Math.floor(f/(1e3*60*60)),b=Math.floor(f/(1e3*60));if(b<60)return b<=1?"Just now":`${b} minutes ago`;if(v<24)return v===1?"1 hour ago":`${v} hours ago`;if(g===0)return"Today";if(g===1)return"Yesterday";if(g<7)return`${g} days ago`;if(g<30){const d=Math.floor(g/7);return d===1?"1 week ago":`${d} weeks ago`}else if(g<365){const d=Math.floor(g/30);return d===1?"1 month ago":`${d} months ago`}else{const d=Math.floor(g/365);return d===1?"1 year ago":`${d} years ago`}}catch(o){return console.error("Error formatting date:",o),"Unknown date"}};return e.jsx(C,{isOpen:s,onRequestClose:r,className:"fixed inset-0 flex items-center justify-center p-4",overlayClassName:"fixed inset-0 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"User Details"}),e.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),p?e.jsx("div",{className:"flex justify-center items-center h-48",children:e.jsx(U,{})}):y?e.jsx("div",{className:"text-red-500 text-center py-4",children:y}):n?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-600 font-medium",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:n.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-600 font-medium",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:n.email})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-600 font-medium",children:"Role"}),e.jsx("span",{className:`px-2 py-1 inline-flex text-sm font-semibold rounded-full ${n.role==="admin"?"bg-purple-100 text-purple-800":n.role==="organizer"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:n.role})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-600 font-medium",children:"Member Since"}),e.jsx("p",{className:"text-gray-900",children:u(n.createdAt)})]})]}),n.profilePicture&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-gray-600 font-medium mb-2",children:"Profile Picture"}),e.jsx("img",{src:n.profilePicture,alt:`${n.name}'s profile`,className:"w-32 h-32 rounded-full object-cover"})]})]}):e.jsx("div",{className:"text-center py-4",children:"No user data available"})]})})};function S({title:s,titleId:r,...i},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},i),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"}))}const A=t.forwardRef(S);function O({title:s,titleId:r,...i},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},i),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const F=t.forwardRef(O);function z({title:s,titleId:r,...i},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},i),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const B=t.forwardRef(z);function H({title:s,titleId:r,...i},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},i),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const P=t.forwardRef(H);function T({title:s,titleId:r,...i},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},i),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const k=t.forwardRef(T),W=({user:s,onUpdateRole:r,onDelete:i})=>{const[n,x]=t.useState(!1),[p,m]=t.useState(!1),[y,h]=t.useState(!1),[c,u]=t.useState(!1),[l,o]=t.useState(!1),{isDarkMode:a}=E(),f=async d=>{u(!0);try{await r(s._id,d)}finally{u(!1),x(!1)}},g=async()=>{o(!0);try{await i(s._id)}finally{o(!1),m(!1)}},b=(d=>{switch(d){case"admin":return{colorClass:"bg-purple-100 text-purple-800 dark:bg-purple-700 dark:text-purple-200 shadow-sm",icon:e.jsx(B,{className:"w-4 h-4 mr-1"})};case"organizer":return{colorClass:"bg-blue-100 text-blue-800 dark:bg-blue-700 dark:text-blue-200 shadow-sm",icon:e.jsx(A,{className:"w-4 h-4 mr-1"})};case"user":return{colorClass:"bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-200 shadow-sm",icon:e.jsx(k,{className:"w-4 h-4 mr-1"})};default:return{colorClass:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200 shadow-sm",icon:e.jsx(k,{className:"w-4 h-4 mr-1"})}}})(s.role);return e.jsxs(e.Fragment,{children:[e.jsxs(w.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:`rounded-lg p-6 border ${a?"bg-gray-800 border-gray-700":"bg-[#fffef9] border-gray-200"} shadow-md hover:shadow-xl transition-shadow duration-300 
                   flex flex-col md:flex-row justify-between items-start md:items-center space-y-6 md:space-y-0 cursor-pointer ${a?"":"hover:scale-105"}`,onClick:()=>h(!0),children:[e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:`w-5 h-5 mr-2 ${a?"text-blue-500":"text-yellow-500"}`}),e.jsx("div",{className:`text-base font-semibold ${a?"text-gray-900 dark:text-white":"text-gray-800"}`,children:s.name})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:`w-5 h-5 mr-2 ${a?"text-blue-500":"text-yellow-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-1 9l-4.343-4.343m0 0L9.657 17.657m0 0l-4.343 4.343m0 0A9 9 0 1020 11a9 9 0 00-11.468 5.16m0 0L7 19m4 4v-4m-3 0H9m10 0h2"})}),e.jsx("div",{className:`text-sm ${a?"text-gray-600 dark:text-gray-400":"text-gray-800"}`,children:s.email})]}),e.jsxs("div",{className:"flex items-center md:col-span-2",children:[e.jsx("svg",{className:`w-5 h-5 mr-2 ${a?"text-blue-500":"text-yellow-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V4a1 1 0 011-1h3a1 1 0 011 1v2m-4 0h4"})}),e.jsxs("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full capitalize flex items-center ${b.colorClass}`,children:[b.icon,s.role]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4 items-stretch md:items-center ml-0 md:ml-4",children:[e.jsx(w.button,{onClick:d=>{d.stopPropagation(),x(!0)},className:`text-sm px-4 py-2 border border-blue-600 dark:border-blue-500 text-blue-600 dark:text-blue-400 rounded-md hover:bg-blue-50 dark:hover:bg-blue-900 transition-colors duration-200 w-full md:w-auto text-center
              ${c?"opacity-50 cursor-not-allowed":""}`,disabled:c,whileHover:{scale:c?1:1.05},whileTap:{scale:c?1:.95},children:c?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 mr-1.5 text-blue-600 dark:text-blue-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l2-2.647z"})]}),"Updating..."]}):e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx(F,{className:"w-4 h-4 mr-1"}),"Update Role"]})}),e.jsx(w.button,{onClick:d=>{d.stopPropagation(),m(!0)},className:`text-sm px-4 py-2 bg-red-500 dark:bg-red-600 text-white font-semibold rounded-md hover:bg-red-600 dark:hover:bg-red-700 transition-colors duration-200 shadow-md w-full md:w-auto text-center
              ${l?"opacity-50 cursor-not-allowed":""}`,disabled:l,whileHover:{scale:l?1:1.05},whileTap:{scale:l?1:.95},children:l?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 mr-1.5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l2-2.647z"})]}),"Deleting..."]}):e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx(P,{className:"w-4 h-4 mr-1"}),"Delete"]})})]})]}),e.jsx(D,{isOpen:n,onClose:()=>x(!1),onUpdate:f,currentRole:s.role,userName:s.name}),e.jsx(L,{isOpen:p,onClose:()=>m(!1),onConfirm:g,title:"Delete User",message:`Are you sure you want to delete ${s.name}? This action cannot be undone.`}),e.jsx($,{isOpen:y,onClose:()=>h(!1),userId:s._id})]})},_=()=>{const[s,r]=t.useState([]),[i,n]=t.useState(!0),[x,p]=t.useState(null);t.useEffect(()=>{m()},[]);const m=async()=>{var c,u;try{n(!0);const l=await N.get("/users");r(l.data.data),p(null)}catch(l){console.error("Error fetching users:",l);const o=((u=(c=l.response)==null?void 0:c.data)==null?void 0:u.message)||"Failed to fetch users";p(o),j.error(o)}finally{n(!1)}},y=async(c,u)=>{var l,o;try{r(a=>a.map(f=>f._id===c?{...f,role:u,isUpdating:!0}:f)),await N.put(`/users/${c}`,{role:u}),j.success("User role updated successfully"),m()}catch(a){console.error("Error updating user:",a);const f=((o=(l=a.response)==null?void 0:l.data)==null?void 0:o.message)||"Failed to update user role";p(f),j.error(f),m()}},h=async c=>{var u,l;try{r(o=>o.map(a=>a._id===c?{...a,isDeleting:!0}:a)),await N.delete(`/users/${c}`),j.success("User deleted successfully"),r(o=>o.filter(a=>a._id!==c))}catch(o){console.error("Error deleting user:",o);const a=((l=(u=o.response)==null?void 0:u.data)==null?void 0:l.message)||"Failed to delete user";j.error(a),m()}};return i?e.jsx("div",{className:"container mx-auto px-4 py-8 min-h-screen-except-nav-footer flex items-center justify-center",children:e.jsx(U,{type:"spinner",size:"large",text:"Loading users..."})}):x?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"p-4 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg shadow-md",children:x})}):e.jsxs(w.div,{initial:{opacity:0},animate:{opacity:1},className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white mb-6",children:"User Management"}),e.jsx(w.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 md:p-6",children:s.length===0?e.jsx("div",{className:"text-center text-gray-600 dark:text-gray-400 py-8",children:"No users found."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(R,{children:s.map(c=>e.jsx(W,{user:c,onUpdateRole:y,onDelete:h},c._id))})})})]})};export{_ as default};
