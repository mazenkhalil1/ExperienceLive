import{r,b as w,j as t,m as I,n as j,Q as d,d as k,R as N}from"./index-DMHo1UD5.js";const C=()=>{const[c,b]=r.useState(""),[u,s]=r.useState(null),[i,l]=r.useState(!1),[g,m]=r.useState(""),y=w(),a=localStorage.getItem("userId");r.useEffect(()=>{(async()=>{if(a)try{await j.post("/auth/send-otp",{userId:a}),m("OTP sent to your email.")}catch(n){console.error("Failed to send OTP:",n),m("Failed to send OTP. Try again.")}})()},[a]);const h=o=>{b(o.target.value),s(null)},v=async o=>{var n,f,p,x;if(o.preventDefault(),l(!0),s(null),!a){const e="User ID not found. Try logging in again.";s(e),d.error(e),l(!1);return}try{const e=await k.post("/auth/verify-otp",{userId:a,otp:c});e.data.success?(d.success("MFA verified!"),localStorage.removeItem("userId"),y(N.HOME)):(s(e.data.message||"Invalid code."),d.error(e.data.message||"Invalid code."))}catch(e){console.error("Verification error:",e),s(((f=(n=e.response)==null?void 0:n.data)==null?void 0:f.message)||"Verification failed."),d.error(((x=(p=e.response)==null?void 0:p.data)==null?void 0:x.message)||"Verification failed.")}finally{l(!1)}};return t.jsx(I.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-lg shadow-md w-full max-w-sm text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800 dark:text-white",children:"Enter MFA Code"}),g&&t.jsx("p",{className:"text-green-600 dark:text-green-400 mb-4 text-sm",children:g}),t.jsxs("form",{onSubmit:v,className:"space-y-4",children:[t.jsx("input",{type:"text",id:"mfaCode",name:"mfaCode",maxLength:"6",value:c,onChange:h,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"Enter 6-digit code",required:!0}),u&&t.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm",children:u}),t.jsx("button",{type:"submit",disabled:i,className:`w-full px-4 py-2 bg-blue-600 text-white font-semibold rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-600 ${i?"opacity-50 cursor-not-allowed":""}`,children:i?"Verifying...":"Verify Code"})]})]})})};export{C as default};
