import{r as a,u as $,a as S,b as F,c as M,j as e,m as R,L as w,d as P,Q as d,R as v}from"./index-B3r4mDoR.js";function I({openRegisterModal:q}){var f;const[u,g]=a.useState(""),[m,j]=a.useState(""),[l,x]=a.useState(!1),[b,i]=a.useState(null),{login:k}=$(),{isDarkMode:s}=S(),r=F(),c=M();a.useEffect(()=>{const t=n=>{n.key==="Escape"&&r(-1)};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[r]),a.useEffect(()=>{var t;(t=c.state)!=null&&t.email&&g(c.state.email)},[(f=c.state)==null?void 0:f.email]);const N=async t=>{var n,y,h,p;t.preventDefault(),x(!0),i(null);try{console.log("Attempting login...");const o=await P.post("/login",{email:u,password:m});if(console.log("Login successful:",o.data),o.data.mfaRequired)console.log("MFA is required. Redirecting to MFA prompt."),localStorage.setItem("userId",o.data.userId),d.info("MFA required. Please enter the code sent to your email."),r(v.MFA_PROMPT);else{console.log("Standard login successful.");const L=o.data.user,E=o.data.token;k(L,E),i(null),d.success("Login successful!"),r(v.HOME)}}catch(o){console.error("Login failed:",o),i(((y=(n=o.response)==null?void 0:n.data)==null?void 0:y.message)||"Failed to login"),d.error(((p=(h=o.response)==null?void 0:h.data)==null?void 0:p.message)||"Failed to login")}finally{x(!1)}};return e.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3},className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm"}),e.jsxs("div",{className:`relative max-w-md w-full mx-4 p-8 ${s?"bg-gray-800":"bg-white"} rounded-2xl shadow-xl z-10`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 text-center ${s?"text-white":"text-gray-800"}`,children:"Login"}),e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Email"}),e.jsx("input",{type:"email",value:u,onChange:t=>g(t.target.value),required:!0,className:`mt-1 block w-full px-3 py-2 border ${s?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-black"} rounded-lg shadow-sm focus:outline-none ${s?"focus:ring-blue-500 focus:border-blue-500":"focus:ring-yellow-500 focus:border-yellow-500"} transition-colors duration-200`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Password"}),e.jsx("input",{type:"password",value:m,onChange:t=>j(t.target.value),required:!0,className:`mt-1 block w-full px-3 py-2 border ${s?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-black"} rounded-lg shadow-sm focus:outline-none ${s?"focus:ring-blue-500 focus:border-blue-500":"focus:ring-yellow-500 focus:border-yellow-500"} transition-colors duration-200`})]}),b&&e.jsx("p",{className:"text-red-500 text-sm text-center",children:b}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l,className:`w-full flex justify-center py-2 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white ${l?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200`,children:l?"Logging in...":"Login"})}),e.jsx("div",{className:"text-center",children:e.jsx(w,{to:"/register",className:`text-sm ${s?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-500"} transition-colors duration-200`,children:"Don't have an account? Register"})}),e.jsx("div",{className:"text-center",children:e.jsx(w,{to:"/forgot-password",className:`text-sm ${s?"text-gray-400 hover:text-gray-300":"text-gray-600 hover:text-gray-800"} transition-colors duration-200`,children:"Forgot Password?"})})]})]})]})}export{I as default};
